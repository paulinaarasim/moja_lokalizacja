<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Geolokalizacja w React</title>

  <!-- Import Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-sA+oDHRZImxTgKfJxySl7HhFwB3p3Z1N6LJ3h6Cjv+U="
    crossorigin=""
  />
  <style>
    #root {
      height: 100vh;
      margin: 0;
      padding: 0;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- React and ReactDOM -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

  <!-- Babel for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- React Leaflet and Leaflet -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/react-leaflet@4.2.1/dist/react-leaflet.min.js"></script>

  <script type="text/babel">
    const { useState, useEffect } = React;
    const { MapContainer, TileLayer, Marker, Popup } = ReactLeaflet;

    function GeoMap() {
      const [location, setLocation] = useState(null);
      const [error, setError] = useState(null);

      useEffect(() => {
        if (!navigator.geolocation) {
          setError("Geolokalizacja nie jest wspierana przez Twoją przeglądarkę");
          return;
        }

        navigator.geolocation.getCurrentPosition(
          (position) => {
            setLocation({
              lat: position.coords.latitude,
              lng: position.coords.longitude,
            });
          },
          (err) => {
            setError("Błąd podczas pobierania lokalizacji: " + err.message);
          }
        );
      }, []);

      if (error) {
        return <div>{error}</div>;
      }

      if (!location) {
        return <div>Ładowanie lokalizacji...</div>;
      }

      return (
        <MapContainer center={[location.lat, location.lng]} zoom={13} style={{ height: "100vh", width: "100%" }}>
          <TileLayer
            attribution='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'
            url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
          />
          <Marker position={[location.lat, location.lng]}>
            <Popup>Jesteś tutaj</Popup>
          </Marker>
        </MapContainer>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<GeoMap />);
  </script>
</
